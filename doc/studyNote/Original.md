# Original

On 24-10-30, 徐銘鴻214 wrote:

> I understand that the ASN.1 version isn’t the primary concern. Currently, Nokia has requested a diff comparison to help them resolve the ASN1c issue. They’ve also sent a test file, hoping I can test it and provide feedback for repair. I’m currently working on this.

>

> However, in OSC, they need the entire community’s agreement before making changes. Ankit believes the best solution is to wait for Nokia to fix the compiler. If I want to replace ASN1c ourselves, it would be limited to internal testing. Of course, I’ve tried it, but I still encountered some problems that I’ll briefly describe:

Yes, he told us that changing the ASN1c compiler would be cumbersome. I

indeed meant this was for testing.

> While waiting for Nokia to fix the compiler, I have some ideas to try and solve the problem on my own. Based on my previous tests, I know that if we want to use mouse07410’s ASN1c to encode SIB1 in OSC, we need to modify the OSC source code because I’ve found dozens of variable name mismatches that cause issues during compilation.

Correct. FYI, that can also happen when up/downgrading the RRC version.

For instance, this looks like this, maybe it will help you:

[https://gitlab.eurecom.fr/oai/openairinterface5g/-/merge_requests/1998](https://gitlab.eurecom.fr/oai/openairinterface5g/-/merge_requests/1998)

> However, even after making modifications, there are still issues with the ASN1 of the F1AP struct. Therefore, I’ve also rebuilt F1AP and E2AP using mouse07410’s ASN1c, but I encountered error logs in the compiler (unknown type name) ASN.1 file build: unknown type name <

[https://www.notion.so/ntust-bmwlab/ASN-1-file-build-unknown-type-name-1221009831438027a679c6b997f60b5b?pvs=24](ASN%201%20file%20build%20unknown%20type%20name%201221009831438027a679c6b997f60b5b.md)

>​ You can refer to the log below for more details.

> ```

> -e Compiling [31m[1m /home/hpe/o-du-l2/src/codec_utils/F1AP/DRX-Config.c [m

> -e Compiling [31m[1m /home/hpe/o-du-l2/src/codec_utils/F1AP/DRXConfigurationIndicator.c [m

> In file included from /home/hpe/o-du-l2/src/codec_utils/F1AP/NR-Mode-Info.h:60,

>                  from /home/hpe/o-du-l2/src/codec_utils/F1AP/Served-Cell-Information.h:20,

>                  from /home/hpe/o-du-l2/src/codec_utils/F1AP/GNB-DU-Served-Cells-Item.h:15,

>                  from /home/hpe/o-du-l2/src/codec_utils/F1AP/ProtocolIE-Field.h:24,

>                  from /home/hpe/o-du-l2/src/codec_utils/F1AP/ProtocolIE-Container.h:484,

>                  from /home/hpe/o-du-l2/src/codec_utils/F1AP/DLRRCMessageTransfer.h:15,

>                  from /home/hpe/o-du-l2/src/codec_utils/F1AP/DLRRCMessageTransfer.c:8:

> /home/hpe/o-du-l2/src/codec_utils/F1AP/ProtocolIE-SingleContainer.h:22:9: error: unknown type name ‘F1AP_PDU_ExtIEs_t’

>    22 | typedef F1AP_PDU_ExtIEs_t  ProtocolIE_SingleContainer_4590P0_t;

>       |         ^~~~~~~~~~~~~~~~~

> /home/hpe/o-du-l2/src/codec_utils/F1AP/ProtocolIE-SingleContainer.h:23:9: error: unknown type name ‘ResetType_ExtIEs_t’

>    23 | typedef ResetType_ExtIEs_t  ProtocolIE_SingleContainer_4590P1_t;

>       |         ^~~~~~~~~~~~~~~~~~

> ```

which version of F1AP do you use?

The same file (in OAI, in the build directory)

"openair2/F1AP/MESSAGES/F1AP_ProtocolIE-SingleContainer.h" contains

these types.  The first type is F1AP_ProtocolIE-Field.h which is

in F1AP_ProtocolIE-Field.h, and which is included directly at the top.

I attach both files as generated by OAI in develop. Can you send your

files for this?

Note also at the top of the files how they have been cmopiled.

> I’ve exhausted all my ideas for this problem, but my next step is to begin with SIB1. I’ll start by modifying the struct definition and attempting internal testing to resolve issues with SIB1 and F1AP ASN1 encoding.

>

> Additionally, this is the latest UE log. By comparing the differences with the OAI Layer2, I have confirmed that there is indeed a problem with the CellGroupConfig not decoding in UE.

Not sure. There is a segfault because something is not set as we expect

it to. That does not necessarily mean that the CellGroupConfig has not

been decoded. It can also simply be that there is some configuration

that is not actually present in the CellGroupConfig (which OAI UE

blindly seems to assume), which might or might not be a bug on either

side.

CellGroupConfig decoding is when a call to uper_decode() fails! not a

random segv!

So no, you jumped too fast to a conclusion here(!) The question now, why

is the segv? You should find that out. Can you please send back a full backtrace?

gdb> bt full

Robert