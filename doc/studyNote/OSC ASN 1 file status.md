# OSC ASN.1 file status

Start Date: 2024/10/16
Summary: Development and analysis of OSC ASN.1 files, including version control, compiler differences, and duplicate file identification.
Status: Done
Assign: Ming ÂíöÂíö [ÈäòÈ¥ª]
Finish Date: 2025/01/17
SUM: üóìÔ∏è Days Spent to Complete: 93

## 1. Project Structure

Key ASN.1 file directories:

- COMMON ‚Üí [OSC common  ASN.1 file](OSC%20common%20ASN%201%20file%2012110098314381598f71f038b9794b83.md)
- RRC ‚Üí [OSC RRC ASN.1 file](OSC%20RRC%20ASN%201%20file%20121100983143816c86a6e7063521baf1.md)
- F1AP ‚Üí [OSC F1AP ASN.1 file](OSC%20F1AP%20ASN%201%20file%201211009831438070bb80c050fcf47cdf.md)
- E2AP ‚Üí [OSC E2AP ASN.1 file](OSC%20E2AP%20ASN%201%20file%2012110098314380ebbef6c4d726bd0894.md)

## 2. Version Control Analysis

Compare specific directories between different branches:

```jsx
git diff i-release FixASN1_afterGetSouceFile -- src/codec_utils/
```

Detailed comparison commands and results:

```jsx
hpe@hpe-ProLiant-DL380-Gen10:~/o-du-l2$ git diff i-release FixASN1_afterGetSouceFile -- src/codec_utils/E2AP
hpe@hpe-ProLiant-DL380-Gen10:~/o-du-l2$ git diff i-release FixASN1_afterGetSouceFile -- src/codec_utils/common/
hpe@hpe-ProLiant-DL380-Gen10:~/o-du-l2$ git diff i-release FixASN1_afterGetSouceFile -- src/codec_utils/F1AP/
hpe@hpe-ProLiant-DL380-Gen10:~/o-du-l2$ git diff i-release FixASN1_afterGetSouceFile -- src/codec_utils/RRC/
diff --git a/src/codec_utils/RRC/AMF-Identifier.c b/src/codec_utils/RRC/AMF-Identifier.c
index 6d524b33..4b34c547 100644
--- a/src/codec_utils/RRC/AMF-Identifier.c
+++ b/src/codec_utils/RRC/AMF-Identifier.c
@@ -1,8 +1,8 @@
 /*
  * Generated by asn1c-0.9.29 (http://lionet.info/asn1c)
  * From ASN.1 module "NR-RRC-Definitions"
- *     found in "../ASN1_Input/rrc_15_3_asn.asn1"
- *     `asn1c -D ../RRC_output_14Nov/ -fcompound-names -fno-include-deps -findirect-choice -gen-PER`
+ *     found in "/home/hpe/NTUST-script/CONFIG/rrc_15_3.asn1"
+ *     `asn1c -pdu=all -fcompound-names -gen-UPER -no-gen-BER -no-gen-JER -no-gen-OER -gen-APER -no-gen-example -findirect-choice -D ./temp`
```

## 3. Compiler Differences and Issues

Key differences between OSC and OAI compilers:

- OSC compiler (Nokia): Lower support, requires COMMON folder for additional functions
- OAI compiler: More comprehensive functionality, includes COMMON features

### Current Issues:

<aside>
Problem Summary:
When using the OAI compiler, we encounter duplicate function declarations issues, which we suspect is related to the files in the COMMON folder

</aside>

Example of duplicate definition errors:

```
-e Compiling [31m[1m /home/hpe/o-du-l2/src/phy_stub//phy_stub_ex_ms.c [m
-e Compiling [31m[1m /home/hpe/o-du-l2/src/phy_stub//phy_stub_msg_hdl.c [m
-e Compiling [31m[1m /home/hpe/o-du-l2/src/phy_stub//phy_stub_thread_hdl.c [m
-e Creating Archive [31m[1m /home/hpe/o-du-l2/build/odu/lib/odu/libphystub.a [m
make[1]: Leaving directory '/home/hpe/o-du-l2/build/odu'
/usr/bin/ld: /home/hpe/o-du-l2/build/odu/obj/odu/ANY_aper.o: in function `ANY_fromType_aper':
/home/hpe/o-du-l2/src/codec_utils/RRC/ANY_aper.c:20: <h color="red">multiple definition of `ANY_fromType_aper'; /home/hpe/o-du-l2/build/odu/obj/odu/ANY.o:/home/hpe/o-du-l2/src/codec_utils/common/ANY.c:116: first defined here</h>
```

## 4. Current Solutions and Status

- Files extracted and moved to common folder after OAI compilation
- Unused encoding methods manually removed
- Current status: F1AP, E2AP, E2SM_KPM, and RRC pass OSC compiler

Currently, F1AP, E2AP, E2SM_KPM, and RRC can all pass the OSC compiler, but when compiling du_app, there are file not found errors. This should be due to version differences. The solution could be either modifying to match the original corresponding version or individually restoring the required files.

## 5. Duplicate File Analysis

Script for identifying duplicate files:

```bash
#!/bin/bash

DIRECTORIES=("common" "E2AP" "E2SM_KPM" "F1AP" "RRC")

declare -A file_hashes

for dir in "${DIRECTORIES[@]}"; do
    for file in "$dir"/*; do
        if [[ -f "$file" ]]; then
            hash=$(md5sum "$file" | awk '{print $1}')
            if [[ -n "${file_hashes[$hash]}" ]]; then
                echo "Duplicate file found:"
                echo "${file_hashes[$hash]}"
                echo "$file"
                echo
            else
                file_hashes[$hash]=$file
            fi
        fi
    done
done
```

Example of duplicate files found:

```bash
 ./compare.sh
Duplicate file found:
E2SM_KPM/NULL_aper.c
F1AP/NULL_aper.c

Duplicate file found:
E2SM_KPM/NULL.c
F1AP/NULL.c

[Additional duplicate files listed...]
```